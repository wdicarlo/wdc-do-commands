#!/usr/bin/env bash


cpath=`pwd`
bookmarks=~/.bookmarks

if [ $cpath == $HOME ]; then
    #cat $bookmarks | sed "s#$HOME/##" 
    cat $bookmarks | grep -v $PROJECTS | xargs -I@ sh -c "if [ -d @ ]; then echo @; fi"| sed "s#$HOME/##" | grep -v "^$HOME$"
    exit
fi


 # check if the bookmark is not already present
n=`cat $bookmarks | grep -E "^$cpath$" | wc -l`

if [ $n == 0 ]; then
    #add bookmark
    echo "$cpath" >> $bookmarks

    # filter bookmark file
    file=`cat $bookmarks`;echo  "$file" | sort > $bookmarks
fi

# highlight the added path
if [ "$PROJECT" == "" ]; then
    relpath=`echo $cpath|sed "s#$HOME/##"`
    cat $bookmarks | grep -v $PROJECTS | xargs -I@ sh -c "if [ -d @ ]; then echo @; fi"| sed "s#$HOME/##" | grep -v "^$HOME$"| grep --color "^\|$relpath$"
else
    relpath=`echo $cpath|sed "s#$PROJECT_PATH/##"`
    cat $bookmarks | grep "$PROJECT_PATH/" | xargs -I@ sh -c "if [ -d @ ]; then echo @; fi"|  sed "s#$PROJECT_PATH/##" | grep --color "^\|$relpath$"
fi
